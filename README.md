# Test-tast-Ozon-bank

**Задание:**

Дано API: https://akabab.github.io/superhero-api/ с информацией по супергероям.
Необходимо написать функцию, которая принимает на вход пол и наличие работы (булево значение) и возвращает по этим критериям самого высокого героя.

Также для этой функции нужно написать все возможные тесты.

## Описание выполнения задания
### Функция
1. Функция валидирует принимаемые параметры на тип данных и их значение.
2. Цикл итерируется по `id` пока запросы к API не вернут ошибку `invalid id`.
3. В цикле происходит два запроса к API:
   - `https://www.superheroapi.com/api.php/<token>/<id>/work`
   - `https://www.superheroapi.com/api.php/<token>/<id>/appearance`
4. Если супергерой подходит под критерии, то происходит проверка роста в см.
5. В результате формируется список супергероев с самым высоким ростом. Далее для каждого супергероя по его идентификатору формируется запрос к API:
   - `https://www.superheroapi.com/api.php/<token>/<id>` 

### Тесты
Тесты реализованы с использованием фреймворка pytest. Всего реализовано 7 параметризированных тестов на 18 сценариев, из которых 10 позитивных (завершаются успешно) и 8 негативных (завершаются с ошибкой).

Команда для просмотра тестов:
`pytest --collect-only`

| Название теста                 | Описание теста                                                                                 |
| ------------------------------ | ---------------------------------------------------------------------------------------------- |
| test_correct_params            | На вход подаются корректные данные, которые сравниваются с предварительно загруженными данными |
| test_very_long_gender          | В переменную gender передается длинная строка для проверки переполнения                        |
| test_uncorrect_token           | Во время теста токен меняется на неверный, ожидается exception                                 |
| test_uncorrect_type_gender     | На вход подается некорректный тип для переменной gender                                        |
| test_empty_gender              | На вход подается некорректое значение для переменной gender (пустая строка)                    |
| test_gender_with_space         | На вход подается некорректное значение для переменной gender (строка, состоящая из пробелов)   |
| test_uncorrect_type_is_working | На вход подается некорректный тип для булевой переменной is_working                            |



## Настройка тестового окружения

0) Повторить действия согласно инструкции https://akabab.github.io/superhero-api/
1) Склонировать репозиторий и перейти в папку `Test-tast-Ozon-bank`

2) Настроить виртуальное окружение

    Для Linux:
    ```
    python3 -m venv .venv
    source .venv/bin/activate
    ```
3) Установить зависимости
   ```
   pip install requirements.txt
   ```
4) **ВАЖНО !**

   Для запуска тестов нужен токен доступа (https://superheroapi.com/), который необходимо поместить в переменную окружения.

   Если запуск производится с терминала, то:

   ```
   $ export ACCESS_TOKEN=<your_token>
   $ pytest test_func_get_tallest_superhero.py
   ```

## Запуск тестов

!!! Перед запуско тестов нужно установить токен доступа как переменную окружения ACCESS_TOKEN

Запуск всех тестов:
```
pytest test_func_get_tallest_superhero.py
```
Запуск позитивных сценариев:
```
pytest -m positive test_func_get_tallest_superhero.py
```
Запуск негативных сценариев:
```
pytest -m negative test_func_get_tallest_superhero.py
```
Запуск одного теста:
```
pytest test_func_get_tallest_superhero.py::test_uncorrect_token
```

## Результат тестов
Можно запустить тесты с генерацией allure-отчета (предварительно установив allure и библиотеку allure-pytest):

Пример отчета:
